var RevealClose=function(){var e={};return e.action=function(t){e.hide(),RevealTextarea.resize(t)},e.event=function(t){t.find(".reveal-close-trigger").click(function(){e.action(t)})},e.hide=function(){$(".reveal").removeAttr("data-reveal-open"),$(".reveal").next().removeAttr("data-reveal-active"),$("body").removeClass("reveal-open")},e}(),RevealIframe=function(){var e={};return e.eventLoaded=function(e,t){e.find("iframe").ready(function(){})},e.setTemplate=function(e,t){$.ajax({url:t.root+"/plugin.reveal.template2",type:"POST",data:{id:t.id,language:t.language,uri:t.uri,filename:t.template},field:e,success:function(t){var n=e.find("iframe").prop("contentDocument");n.open(),n.write(t)}})},e.setContent=function(t,n){$.ajax({url:n.root+"/plugin.reveal.content",type:"POST",data:{id:n.id,language:n.language,filter:n.filter,content:RevealTextarea.getContent(t)},field:t,success:function(a){t.find("iframe").contents().find(n.selector).html(a),e.eventLoaded(t,n)}})},e.setHeight=function(e){var t=e.find("iframe"),n=t.contents().find("body").height(),a=(t.contents().find("html").height(),n);t.css("height",a+"px"),t.contents().find("body").css("overflow-y","hidden")},e.refreshTimeout=function(e,t){return window.clearTimeout(this.reveal_timeout),this.reveal_timeout=window.setTimeout(function(){RevealIframe.setContent(e,t)},t.delay),this.reveal_timeout},e}(),RevealKey=function(){var e={};return e.event=function(t,n){e.key(t,n),e.enter(t,n)},e.key=function(e,t){e.find("textarea").on("input drop",function(n){RevealOpen.isOpen()&&RevealIframe.refreshTimeout(e,t)})},e.enter=function(e,t){e.find("textarea").on("keydown",function(n){RevealOpen.isOpen()&&(13==n.which?(0==this.enter&&RevealIframe.setContent(e,t),this.enter=1):this.enter=0)})},e}(),RevealModal=function(){var e={};return e.action=function(t){e.event(t)},e.event=function(e){$(".modal, .structure-add-button, .modal .btn-cancel").click(function(){console.log("NJA"),$("[data-reveal-open]").closest(".field").each(function(e){console.log("JAA"),RevealClose.action($(this))}),$(".reveal").removeAttr("data-reveal-open"),$(".reveal").next().removeAttr("data-reveal-active"),$("body").removeClass("reveal-open"),RevealTextarea.resize(e)})},e}(),RevealOpen=function(){var e={};return e.event=function(t,n){t.find(".reveal-open-trigger").click(function(){e.open(t),RevealTextarea.resize(t),RevealIframe.setContent(t,n)})},e.open=function(e){$("body").find(".reveal").removeAttr("data-reveal-open"),$("body").find(".reveal").next().removeAttr("data-reveal-active"),e.find(".reveal").attr("data-reveal-open",!0),e.find(".reveal").next().attr("data-reveal-active",!0),$("body").addClass("reveal-open")},e.isOpen=function(){return $("body").hasClass("reveal-open")},e}(),RevealRefresh=function(){var e={};return e.event=function(e,t){e.find(".reveal-refresh-trigger").click(function(){RevealIframe.setContent(e,t)})},e}(),RevealResize=function(){var e={};return e.event=function(t){$(window).resize(function(){var n=e.widthToEm(t);50>n&&RevealClose.action(t)})},e.widthToEm=function(e){var t=$(window).width(),n=parseFloat($("body").css("font-size"));return t/n},e}();!function(e){e.fn.reveal=function(){return this.each(function(){var t=e(this),n="reveal";return t.data(n)?!0:(t.data(n,!0),void e.fn.actions(t,e.fn.getData(t)))})},e.fn.getData=function(e){var t=e.find(".reveal").attr("data-reveal");return jQuery.parseJSON(t)},e.fn.actions=function(t,n){RevealClose.action(t),RevealIframe.setTemplate(t,n),e.fn.events(t,n)},e.fn.events=function(e,t){RevealRefresh.event(e,t),RevealModal.event(e,t),RevealTextarea.onClick(e,t),RevealKey.event(e,t),RevealOpen.event(e,t),RevealClose.event(e),RevealResize.event(e),RevealIframe.eventLoaded(e,t)}}(jQuery);var RevealTextarea=function(){var e={};return e.resize=function(e){e.find("textarea").trigger("autosize.resize")},e.getContent=function(e){return e.find("textarea").val()},e.onClick=function(e,t){e.find(".field-buttons button").on("click",function(){RevealIframe.refreshTimeout(e,t)})},e}();